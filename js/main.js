angular.module('charts', [])
  .directive('chartExample', function () {
    return {
      restrict: 'E',
      template: '<div></div>',
      scope: {
        options: '='
      },

      link: function (scope, element) {
        var chart = new Highcharts.StockChart(scope.options);
      }
    };
  })

  .controller('chartController', function ($scope) {
    $scope.randomizeSeries = function() {
      var chart = $('#chart-container').highcharts();

      chart.series.forEach(function(series) {
        var updatedData = [];
        series.data.forEach(function(data) {
          var change = Math.random() * (2 - 0);
          var random = Math.floor(Math.random() * (2 - 0));
          console.log(random);
          updatedData.push([data.x, (random === 0) ? data.y - change : data.y + change]);
        });

        series.setData(updatedData);
      });
    };

    $scope.changeType = function(type) {
      var chart = $('#chart-container').highcharts();

      chart.series.forEach(function(series) {
        series.update({
          type: type
        });
      });
    };

    $scope.exampleOptions = {
      chart: {
        animation: true,
        renderTo: 'chart-container',
        width: 800
      },

      title: {
        text: 'Value'
      },
      xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
      },
      series: [{
        data: [[1242259200000,17.56],[1242345600000,17.49],[1242604800000,18.09],[1242691200000,18.21],[1242777600000,17.98],[1242864000000,17.74],[1242950400000,17.5],[1243296000000,18.68],[1243382400000,19.01],[1243468800000,19.3],[1243555200000,19.4],[1243814400000,19.91],[1243900800000,19.93],[1243987200000,20.14],[1244073600000,20.53],[1244160000000,20.67],[1244419200000,20.55],[1244505600000,20.39],[1244592000000,20.04],[1244678400000,19.99],[1244764800000,19.57],[1245024000000,19.44],[1245110400000,19.48],[1245196800000,19.37],[1245283200000,19.41],[1245369600000,19.93],[1245628800000,19.62],[1245715200000,19.14],[1245801600000,19.46],[1245888000000,19.98],[1245974400000,20.35],[1246233600000,20.28],[1246320000000,20.35],[1246406400000,20.4],[1246492800000,20],[1246838400000,19.8],[1246924800000,19.34],[1247011200000,19.6],[1247097600000,19.48],[1247184000000,19.79],[1247443200000,20.33],[1247529600000,20.32],[1247616000000,20.98],[1247702400000,21.07],[1247788800000,21.68],[1248048000000,21.84],[1248134400000,21.64],[1248220800000,22.39],[1248307200000,22.55],[1248393600000,22.86],[1248652800000,22.87],[1248739200000,22.86],[1248825600000,22.86],[1248912000000,23.26],[1248998400000,23.34],[1249257600000,23.78],[1249344000000,23.65],[1249430400000,23.59],[1249516800000,23.42],[1249603200000,23.64],[1249862400000,23.53],[1249948800000,23.26],[1250035200000,23.62],[1250121600000,24.06],[1250208000000,23.83],[1250467200000,22.8],[1250553600000,23.43],[1250640000000,23.51],[1250726400000,23.76],[1250812800000,24.17],[1251072000000,24.15],[1251158400000,24.2],[1251244800000,23.92],[1251331200000,24.21],[1251417600000,24.29],[1251676800000,24.03],[1251763200000,23.61],[1251849600000,23.6],[1251936000000,23.79],[1252022400000,24.33],[1252368000000,24.7],[1252454400000,24.45],[1252540800000,24.65],[1252627200000,24.59],[1252886400000,24.82],[1252972800000,25.02],[1253059200000,25.98],[1253145600000,26.36],[1253232000000,26.43],[1253491200000,26.29],[1253577600000,26.35],[1253664000000,26.5],[1253750400000,26.26],[1253836800000,26.05],[1254096000000,26.59],[1254182400000,26.48],[1254268800000,26.48],[1254355200000,25.84],[1254441600000,26.41],[1254700800000,26.57]]
      }, {
        data: [[1242259200000,8.78],[1242345600000,8.745],[1242604800000,9.045],[1242691200000,9.105],[1242777600000,8.99],[1242864000000,8.87],[1242950400000,8.75],[1243296000000,9.34],[1243382400000,9.505],[1243468800000,9.65],[1243555200000,9.7],[1243814400000,9.955],[1243900800000,9.965],[1243987200000,10.07],[1244073600000,10.265],[1244160000000,10.335],[1244419200000,10.275],[1244505600000,10.195],[1244592000000,10.02],[1244678400000,9.995],[1244764800000,9.785],[1245024000000,9.72],[1245110400000,9.74],[1245196800000,9.685],[1245283200000,9.705],[1245369600000,9.965],[1245628800000,9.81],[1245715200000,9.57],[1245801600000,9.73],[1245888000000,9.99],[1245974400000,10.175],[1246233600000,10.14],[1246320000000,10.175],[1246406400000,10.2],[1246492800000,10],[1246838400000,9.9],[1246924800000,9.67],[1247011200000,9.8],[1247097600000,9.74],[1247184000000,9.895],[1247443200000,10.165],[1247529600000,10.16],[1247616000000,10.49],[1247702400000,10.535],[1247788800000,10.84],[1248048000000,10.92],[1248134400000,10.82],[1248220800000,11.195],[1248307200000,11.275],[1248393600000,11.43],[1248652800000,11.435],[1248739200000,11.43],[1248825600000,11.43],[1248912000000,11.63],[1248998400000,11.67],[1249257600000,11.89],[1249344000000,11.825],[1249430400000,11.795],[1249516800000,11.71],[1249603200000,11.82],[1249862400000,11.765],[1249948800000,11.63],[1250035200000,11.81],[1250121600000,12.03],[1250208000000,11.915],[1250467200000,11.4],[1250553600000,11.715],[1250640000000,11.755],[1250726400000,11.88],[1250812800000,12.085],[1251072000000,12.075],[1251158400000,12.1],[1251244800000,11.96],[1251331200000,12.105],[1251417600000,12.145],[1251676800000,12.015],[1251763200000,11.805],[1251849600000,11.8],[1251936000000,11.895],[1252022400000,12.165],[1252368000000,12.35],[1252454400000,12.225],[1252540800000,12.325],[1252627200000,12.295],[1252886400000,12.41],[1252972800000,12.51],[1253059200000,12.99],[1253145600000,13.18],[1253232000000,13.215],[1253491200000,13.145],[1253577600000,13.175],[1253664000000,13.25],[1253750400000,13.13],[1253836800000,13.025],[1254096000000,13.295],[1254182400000,13.24],[1254268800000,13.24],[1254355200000,12.92],[1254441600000,13.205],[1254700800000,13.285]]
      }],
      rangeSelector : {
        selected : 1
      }
    };
});
